let tops = [
{lv:1	,blocks:9  },
{lv:58	,blocks:8  },
{lv:26	,blocks:13 },
{lv:48	,blocks:17 },
{lv:32	,blocks:10 },
{lv:2	,blocks:3  },
{lv:3	,blocks:6  },
{lv:4	,blocks:9  },
{lv:6	,blocks:5  },
{lv:7	,blocks:10 },
{lv:10	,blocks:9  },
{lv:7	,blocks:9  },
{lv:11	,blocks:10 },
{lv:17	,blocks:13 },
{lv:17	,blocks:16 },
{lv:19	,blocks:8  },
{lv:13	,blocks:5  },
{lv:22	,blocks:9  },
{lv:23	,blocks:10 },
{lv:24	,blocks:13 },
{lv:26	,blocks:12 },
{lv:9	,blocks:14 },
{lv:15	,blocks:11 },
{lv:17	,blocks:14 },
{lv:18	,blocks:15 },
{lv:19	,blocks:11 },
{lv:9	,blocks:16 },
{lv:1	,blocks:7  },
{lv:2	,blocks:7  },
{lv:18	,blocks:18 },
{lv:2	,blocks:9  },
{lv:2	,blocks:5  },
{lv:1	,blocks:5  },
{lv:2	,blocks:11 },
{lv:3	,blocks:7  },
{lv:8	,blocks:6  },
{lv:26	,blocks:15 },
{lv:4	,blocks:10 },
{lv:4	,blocks:13 },
{lv:7	,blocks:12 },
{lv:12	,blocks:11 },
{lv:17	,blocks:12 },
{lv:5	,blocks:11 },
{lv:18	,blocks:14 },
{lv:8	,blocks:7  },
{lv:15	,blocks:10 },
{lv:10	,blocks:11 },
{lv:16	,blocks:11 },
{lv:47	,blocks:14 },
{lv:18	,blocks:17 },
{lv:5	,blocks:13 },
{lv:14	,blocks:11 },
{lv:9	,blocks:18 },
{lv:6	,blocks:7  },
{lv:14	,blocks:12 },
{lv:24	,blocks:12 },
{lv:20	,blocks:14 },
{lv:15	,blocks:12 },
{lv:28	,blocks:15 },
{lv:12	,blocks:9  },
{lv:26	,blocks:11 },
{lv:29	,blocks:16 },
{lv:6	,blocks:11 },
{lv:11	,blocks:11 },
{lv:24	,blocks:14 },
{lv:30	,blocks:23 },
{lv:20	,blocks:16 },
{lv:23	,blocks:12 },
{lv:24	,blocks:10 },
{lv:33	,blocks:13 },
{lv:36	,blocks:19 },
{lv:10	,blocks:10 },
{lv:22	,blocks:11 },
{lv:13	,blocks:9  },
{lv:25	,blocks:16 },
{lv:35	,blocks:15 },
{lv:42	,blocks:5  },
{lv:29	,blocks:17 },
{lv:45	,blocks:15 },
{lv:35	,blocks:13 },
{lv:39	,blocks:17 },
{lv:44	,blocks:13 },
{lv:45	,blocks:16 },
{lv:27	,blocks:24 },
{lv:45	,blocks:14 },
{lv:51	,blocks:11 },
{lv:29	,blocks:13 },
{lv:34	,blocks:15 },
{lv:35	,blocks:14 },
{lv:45	,blocks:13 },
{lv:46	,blocks:10 },
{lv:49	,blocks:22 },
{lv:50	,blocks:23 },
{lv:10	,blocks:13 },
{lv:11	,blocks:13 },
{lv:31	,blocks:12 },
{lv:35	,blocks:9  },
{lv:52	,blocks:7  },
{lv:43	,blocks:8  },
{lv:50	,blocks:16 },
{lv:39	,blocks:20 },
{lv:46	,blocks:12 },
{lv:51	,blocks:7  },
{lv:55	,blocks:9  },
{lv:53	,blocks:9  },
{lv:56	,blocks:8  },
{lv:55	,blocks:11 },
{lv:57	,blocks:24 },
{lv:47	,blocks:11 },
{lv:32	,blocks:11 },
{lv:60	,blocks:17 },
{lv:21	,blocks:9  },
{lv:44	,blocks:11 },
{lv:34	,blocks:16 },
{lv:30	,blocks:27 },
{lv:31	,blocks:6  },
{lv:55	,blocks:12 },
{lv:39	,blocks:21 },
{lv:6	,blocks:10 },
{lv:46	,blocks:11 },
{lv:36	,blocks:20 },
{lv:36	,blocks:17 },
{lv:44	,blocks:9  },
{lv:59	,blocks:10 },
{lv:58	,blocks:11 },
{lv:60	,blocks:21 },
{lv:40	,blocks:20 },
{lv:40	,blocks:19 },
{lv:30	,blocks:28 },
{lv:49	,blocks:21 },
{lv:40	,blocks:22 },
{lv:48	,blocks:18 },
{lv:53	,blocks:14 },
{lv:8	,blocks:5  },
{lv:7	,blocks:8  },
{lv:15	,blocks:9  },
{lv:21	,blocks:5  },
{lv:5	,blocks:10 },
{lv:8	,blocks:8  },
{lv:5	,blocks:12 },
{lv:16	,blocks:9  },
{lv:9	,blocks:17 },
{lv:17	,blocks:15 },
{lv:20	,blocks:17 },
{lv:3	,blocks:8  },
{lv:12	,blocks:8  },
{lv:7	,blocks:11 },
{lv:13	,blocks:7  },
{lv:15	,blocks:13 },
{lv:14	,blocks:10 },
{lv:8	,blocks:9  },
{lv:11	,blocks:12 },
{lv:14	,blocks:13 },
{lv:33	,blocks:15 },
{lv:19	,blocks:12 },
{lv:25	,blocks:15 },
{lv:26	,blocks:14 },
{lv:27	,blocks:22 },
{lv:33	,blocks:14 },
{lv:53	,blocks:13 },
{lv:31	,blocks:5  },
{lv:34	,blocks:13 },
{lv:37	,blocks:17 },
{lv:31	,blocks:10 },
{lv:36	,blocks:15 },
{lv:40	,blocks:21 },
{lv:43	,blocks:7  },
{lv:44	,blocks:12 },
{lv:46	,blocks:8  },
{lv:9	,blocks:15 },
{lv:20	,blocks:15 },
{lv:46	,blocks:9  },
{lv:36	,blocks:23 },
{lv:50	,blocks:20 },
{lv:4	,blocks:12 },
{lv:3	,blocks:9  },
{lv:50	,blocks:17 },
{lv:54	,blocks:8  },
{lv:33	,blocks:17 },
{lv:43	,blocks:11 },
{lv:53	,blocks:11 },
{lv:57	,blocks:15 },
{lv:59	,blocks:11 },
{lv:57	,blocks:13 },
{lv:30	,blocks:26 },
{lv:57	,blocks:12 },
{lv:38	,blocks:14 },
{lv:28	,blocks:17 },
{lv:29	,blocks:18 },
{lv:28	,blocks:18 },
{lv:54	,blocks:10 },
{lv:59	,blocks:14 },
{lv:60	,blocks:20 },
{lv:1	,blocks:3  },
{lv:5	,blocks:9  },
{lv:16	,blocks:8  },
{lv:24	,blocks:11 },
{lv:4	,blocks:11 },
{lv:39	,blocks:18 },
{lv:18	,blocks:16 },
{lv:19	,blocks:9  },
{lv:49	,blocks:26 },
{lv:20	,blocks:13 },
{lv:19	,blocks:10 },
{lv:25	,blocks:14 },
{lv:12	,blocks:10 },
{lv:49	,blocks:25 },
{lv:27	,blocks:25 },
{lv:29	,blocks:15 },
{lv:35	,blocks:16 },
{lv:34	,blocks:12 },
{lv:30	,blocks:25 },
{lv:47	,blocks:13 },
{lv:38	,blocks:13 },
{lv:39	,blocks:19 },
{lv:45	,blocks:17 },
{lv:25	,blocks:18 },
{lv:60	,blocks:19 },
{lv:31	,blocks:11 },
{lv:23	,blocks:13 },
{lv:37	,blocks:16 },
{lv:44	,blocks:10 },
{lv:47	,blocks:12 },
{lv:50	,blocks:19 },
{lv:53	,blocks:10 },
{lv:23	,blocks:11 },
{lv:21	,blocks:7  },
{lv:60	,blocks:18 },
{lv:37	,blocks:10 },
{lv:32	,blocks:8  },
{lv:43	,blocks:9  },
{lv:3	,blocks:10 },
{lv:13	,blocks:8  },
{lv:22	,blocks:13 },
{lv:1	,blocks:11 },
{lv:37	,blocks:14 },
{lv:28	,blocks:19 },
{lv:59	,blocks:12 },
{lv:27	,blocks:23 },
{lv:38	,blocks:12 },
{lv:12	,blocks:6  },
{lv:13	,blocks:6  },
{lv:14	,blocks:9  },
{lv:11	,blocks:9  },
{lv:16	,blocks:7  },
{lv:38	,blocks:15 },
{lv:56	,blocks:11 },
{lv:6	,blocks:9  },
{lv:27	,blocks:21 },
{lv:16	,blocks:10 },
{lv:28	,blocks:16 },
{lv:47	,blocks:18 },
{lv:25	,blocks:12 },
{lv:10	,blocks:12 },
{lv:38	,blocks:11 },
{lv:41	,blocks:5  },
{lv:37	,blocks:15 },
{lv:23	,blocks:14 },
{lv:56	,blocks:10 },
{lv:40	,blocks:23 },
{lv:48	,blocks:15 },
{lv:58	,blocks:10 },
{lv:33	,blocks:16 },
{lv:48	,blocks:19 },
{lv:34	,blocks:14 },
{lv:52	,blocks:9  },
{lv:49	,blocks:27 } ];

let levels = [
{lv:9	,blocks:10 },
{lv:12	,blocks:6  },
{lv:6	,blocks:5  },
{lv:13	,blocks:4  },
{lv:8	,blocks:5  },
{lv:21	,blocks:5  },
{lv:10	,blocks:9  },
{lv:14	,blocks:9  },
{lv:7	,blocks:8  },
{lv:15	,blocks:9  },
{lv:22	,blocks:9  },
{lv:3	,blocks:6  },
{lv:19	,blocks:8  },
{lv:5	,blocks:9  },
{lv:20	,blocks:17 },
{lv:17	,blocks:12 },
{lv:4	,blocks:9  },
{lv:2	,blocks:3  },
{lv:18	,blocks:14 },
{lv:11	,blocks:9  },
{lv:1	,blocks:3  },
{lv:16	,blocks:7  },
{lv:23	,blocks:10 }];

let t0 = Date.now();
for(let i =0;i<10000;i++){
	let lvs = test(tops,levels);
}
let t1 = Date.now();
console.log('=================');
console.log(t1-t0);

function test(tops,levels){
  let crown = 0;
  let lvs = [];
  if(levels && tops){
	//将tops做映射成二级数组,第一级是关卡，第二级数组是块数
	let lvtops = [];
	for(let it of tops){
	  if(it.lv){
		lvtops[it.lv] = lvtops[it.lv] || [];
		lvtops[it.lv].push(it.blocks);
	  }
	}
	//对二级表进行排序
	for(let it of lvtops){
	  if(it)it.sort((a,b)=>a>b);
	}
	let rank = function(lv,blocks){ //关卡，块数返回排名,没有返回0
	  let tt = lvtops[lv];
	  if(tt){
		for(let i = 0;i<tt.length;i++){
		  if(tt[i] >= blocks){
			return i+1;
		  }
		}
	  }
	  return 0;
	}
	let best = function(lv){
	  let tt = lvtops[lv];
	  if(tt)return tt[0];
	}
	
	for(let it of levels){ //计算每一关的排名
	  if(it.lv && it.lv===+it.lv){
		if(lvtops[it.lv]){
		  lvs[it.lv] = {rank:rank(it.lv,it.blocks),
			lv:it.lv,
			blocks:it.blocks,
			best:best(it.lv)};
		}
		if(lvs[it.lv] && lvs[it.lv].rank === 1)crown++; //统计皇冠数量
	  }
	}
  }
  return lvs;
}